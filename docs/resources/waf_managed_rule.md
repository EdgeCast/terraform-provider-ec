---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "edgecast_waf_managed_rule Resource - terraform-provider-edgecast"
subcategory: ""
description: |-
  
---

# edgecast_waf_managed_rule (Resource)



## Example Usage

```terraform
resource "edgecast_waf_managed_rule" "managed_rule_1" {
    account_number                = "<account_number>"
    name                          = "Terraform Managed Rule #1"
    ruleset_id                    = "ECRS"
    ruleset_version               = "2020-05-01"
    policies                      = [
        "r4020_tw_cpanel.conf.json",
        "r4040_tw_drupal.conf.json",
        "r4030_tw_iis.conf.json",
        "r4070_tw_joomla.conf.json",
        "r4050_tw_microsoft_sharepoint.conf.json",
        "r4060_tw_wordpress.conf.json",
        "r5040_cross_site_scripting.conf.json",
        "r2000_ec_custom_rule.conf.json",
        "r5021_http_attack.conf.json",
        "r5020_http_protocol_violation.conf.json",
        "r5043_java_attack.conf.json",
        "r5030_local_file_inclusion.conf.json",
        "r5033_php_injection.conf.json",
        "r5032_remote_code_execution.conf.json",
        "r5031_remote_file_inclusion.conf.json",
        "r5010_scanner_detection.conf.json",
        "r5042_session_fixation.conf.json",
        "r5041_sql_injection.conf.json",
        "r6000_blocking_evaluation.conf.json"
    ]

    disabled_rule {
                policy_id = "r2000_ec_custom_rule.conf.json"
                rule_id = "431003"
            } 

    general_settings {
        anomaly_threshold = 10
        arg_length =  8000
        arg_name_length = 1024
        combined_file_sizes = 6291456
        ignore_cookie = ["ignoredCookie"]
        ignore_header = ["ignoredHeaders"]
        ignore_query_args = ["ignoredQuery"]
        json_parser = true
        max_num_args = 512
        paranoia_level = 1
        process_request_body = true
        response_header_name = "X-EC-Security-Audit"
        total_arg_length = 64000
        validate_utf8_encoding = true
        xml_parser = true
    }

    rule_target_update {
        is_negated = false
        is_regex = true
        target = "ARGS"
        target_match = "ignoredArgumentException"
        rule_id = "431000"
        replace_target = ""
    }

    rule_target_update {
        is_negated = false
        is_regex = true
        target = "REQUEST_COOKIES"
        target_match = "ignoredCookiesException"
        rule_id = "431000"
        replace_target = ""
    }

    rule_target_update  {
        is_negated = false
        is_regex = true
        target = "REQUEST_HEADERS"
        target_match = "ignoredHeaderException"
        rule_id = "431000"
        replace_target = ""
    }
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- **general_settings** (Block Set, Min: 1, Max: 1) Contains settings that define the profile for a valid request. (see [below for nested schema](#nestedblock--general_settings))
- **ruleset_id** (String) Indicates the ID for the rule set associated with this managed rule.
- **ruleset_version** (String) Indicates the version of the rule set associated with this managed rule.

### Optional

- **account_number** (String) Identifies your account by its customer account number.
- **disabled_rule** (Block Set) This array identifies each rule that has been disabled using these properties (see [below for nested schema](#nestedblock--disabled_rule))
- **id** (String) The ID of this resource.
- **name** (String) Indicates the name of the custom rule.
- **policies** (List of String) Contains a list of policies that have been enabled on this managed rule.
- **rule_target_update** (Block Set) This array describes each target using these properties (see [below for nested schema](#nestedblock--rule_target_update))

### Read-Only

- **created_date** (String) Indicates the date and time at which the managed rule was created.
- **customer_id** (String) Identifies your account by its customer account number.
- **last_modified_by** (String) Reserved for future use.
- **last_modified_date** (String) Indicates the date and time at which the managed rule was last modified.
- **version** (String) Reserved for future use.

<a id="nestedblock--general_settings"></a>
### Nested Schema for `general_settings`

Required:

- **anomaly_threshold** (Number) Indicates the anomaly score threshold.
- **arg_length** (Number) Indicates the maximum number of characters for any single query string parameter value.
- **arg_name_length** (Number) Indicates the maximum number of characters for any single query string parameter name.
- **max_num_args** (Number) Indicates the maximum number of query string parameters.
- **total_arg_length** (Number) Indicates the maximum number of characters for the query string value.

Optional:

- **combined_file_sizes** (Number) Indicates the total file size for multipart message lengths.
- **ignore_cookie** (List of String) Identifies each cookie that will be ignored for the purpose of determining whether a request is malicious traffic.
- **ignore_header** (List of String) Identifies each request header that will be ignored for the purpose of determining whether a request is malicious traffic.
- **ignore_query_args** (List of String) Identifies each query string argument that will be ignored for the purpose of determining whether a request is malicious traffic.
- **json_parser** (Boolean) Determines whether JSON payloads will be inspected. Valid values are: true | false
- **paranoia_level** (Number) Indicates the balance between the level of protection and false positives. Valid values are: 1 | 2 | 3 | 4
- **process_request_body** (Boolean) Determines whether JSON payloads will be inspected.
- **response_header_name** (String) Determines the name of the response header that will be included with blocked requests.
- **validate_utf8_encoding** (Boolean) Indicates whether WAF may check whether a request variable (e.g., ARGS, ARGS_NAMES, and REQUEST_FILENAME) is a valid UTF-8 string.
- **xml_parser** (Boolean) Determines whether XML payloads will be inspected.


<a id="nestedblock--disabled_rule"></a>
### Nested Schema for `disabled_rule`

Optional:

- **policy_id** (String) Identifies a policy from which a rule will be disabled by its system-defined ID.
- **rule_id** (String) Identifies a rule that will be disabled by its system-defined ID.


<a id="nestedblock--rule_target_update"></a>
### Nested Schema for `rule_target_update`

Required:

- **is_regex** (Boolean) Identifies a rule that will be disabled by its system-defined ID.
- **rule_id** (String) Identifies a rule by its system-defined ID.
- **target** (String) Identifies the type of data source (e.g., REQUEST_COOKIES, ARGS, GEO, etc.) for which a target will be created.
- **target_match** (String) Identifies a name or category (e.g., cookie name, query string name, country code, etc.) for the data source defined in the target parameter.

Optional:

- **is_negated** (Boolean) Determines whether the current target, as defined within this object, will be ignored when identifying threats.
- **replace_target** (String) Defines the data source (e.g., REQUEST_COOKIES, ARGS, GEO, etc.) that will be used instead of the one defined in the target parameter.


