---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "ec_waf_access_rule Resource - terraform-provider-edgecast"
subcategory: ""
description: |-
  
---

# ec_waf_access_rule (Resource)



## Example Usage

```terraform
resource "ec_waf_access_rule" "access_rule_1" {
  account_number                = "<Account Number>"
  name                          = "Access Rule #1"
  response_header_name          = "my-response-header-name"
  allowed_http_methods          = ["GET", "POST"]
  allowed_request_content_types = ["application/json","text/html"]
  disallowed_extensions         = [".bat", ".cgi"]
  disallowed_headers            = ["reserved-header-1", "x-reserved-header"]


#Note: ASN access controls must be integer values
  asn {
    accesslist = [12, 200, 465]
    blacklist  = [13, 201, 466]
    whitelist  = [14, 202, 467]
  }

  cookie {
    accesslist = ["MaybeTrustedCookie1", "MaybeTrustedCookie2"]
    blacklist  = ["UntrustedCookie1", "UntrustedCookie2"]
    whitelist  = ["TrustedCookie1", "TrustedCookie2"]
  }

  country {
    accesslist = ["AU", "NZ"]
    blacklist  = ["GB", "EE"]
    whitelist  = ["US", "CAN"]
  }

  ip {
    accesslist = ["10.10.10.114", "10.10.10.115"]
    blacklist  = ["10:0:1::0:3", "10:0:1::0:4"]
    whitelist  = ["10.10.10.200", "10.10.10.201"]
  }

  referer {
    accesslist = ["https://maybetrusted.com", "http://maybestrusted2.com"]
    blacklist  = ["https://untrusted.com", "https://untrusted2.com"]
    whitelist  = ["https://trusted.com", "https://trusted2.com"]
  }

  url {
    accesslist = ["/maybe-trusted", "/maybe-trusted-2"]
    blacklist  = ["/untrusted", "/untrused/.*"]
    whitelist  = ["/trusted-path", "/trusted-path/.*"]
  }

  user_agent {
    accesslist = ["Mozilla\\s.*", "Opera\\s.*"]
    blacklist  = ["curl.*", "PostmanRuntime.*"]
    whitelist  = ["internal-tool/v1", "internal-tool/v2"]
  }
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- **name** (String) Assigns a name to this access rule.

### Optional

- **account_number** (String) Identifies your account by its customer account number.
- **allowed_http_methods** (List of String) Identifies each allowed HTTP method (e.g., GET).
- **allowed_request_content_types** (List of String) Identifies each allowed media type (e.g., application/json).
- **asn** (Block Set, Max: 1) Contains access controls for autonomous system numbers (ASNs).  \
*Note: ASN access controls are integer values.* (see [below for nested schema](#nestedblock--asn))
- **cookie** (Block Set, Max: 1) Contains access controls for cookies. (see [below for nested schema](#nestedblock--cookie))
- **country** (Block Set, Max: 1) Contains access controls for countries. Specify each desired country using its country code. (see [below for nested schema](#nestedblock--country))
- **disallowed_extensions** (List of String) Indicates each file extension for which WAF will send an alert or block the request.
- **disallowed_headers** (List of String) Indicates each request header for which WAF will send an alert or block the request.
- **id** (String) The ID of this resource.
- **ip** (Block Set, Max: 1) Contains access controls for IPv4 and/or IPv6 addresses. Specify each desired IP address using standard IPv4/IPv6 and CIDR notation. (see [below for nested schema](#nestedblock--ip))
- **referer** (Block Set, Max: 1) Contains access controls for referrers.  \
*Note: All referrers defined within a whitelist, accesslist, or blacklist are regular expressions.* (see [below for nested schema](#nestedblock--referer))
- **response_header_name** (String) Determines the name of the response header that will be included with blocked requests.
- **url** (Block Set, Max: 1) Contains access controls for URL paths. Specify a URL path pattern that starts directly after the hostname. Exclude a protocol or a hostname when defining value | values. Sample values: /marketing, /800001/mycustomerorigin.  \
*Note: All URL paths defined within a whitelist, accesslist, or blacklist are regular expressions.* (see [below for nested schema](#nestedblock--url))
- **user_agent** (Block Set, Max: 1) Contains access controls for user agents.  \
*Note: All user agents defined within a whitelist, accesslist, or blacklist are regular expressions.* (see [below for nested schema](#nestedblock--user_agent))

<a id="nestedblock--asn"></a>
### Nested Schema for `asn`

Optional:

- **accesslist** (List of Number) Contains entries that identify traffic that may access your content upon passing a threat assessment.
- **blacklist** (List of Number) Contains entries that identify traffic that will be blocked or for which an alert will be generated.
- **whitelist** (List of Number) Contains entries that identify traffic that may access your content without undergoing threat assessment.


<a id="nestedblock--cookie"></a>
### Nested Schema for `cookie`

Optional:

- **accesslist** (List of String) Contains entries that identify traffic that may access your content upon passing a threat assessment.
- **blacklist** (List of String) Contains entries that identify traffic that will be blocked or for which an alert will be generated.
- **whitelist** (List of String) Contains entries that identify traffic that may access your content without undergoing threat assessment.


<a id="nestedblock--country"></a>
### Nested Schema for `country`

Optional:

- **accesslist** (List of String) Contains entries that identify traffic that may access your content upon passing a threat assessment.
- **blacklist** (List of String) Contains entries that identify traffic that will be blocked or for which an alert will be generated.
- **whitelist** (List of String) Contains entries that identify traffic that may access your content without undergoing threat assessment.


<a id="nestedblock--ip"></a>
### Nested Schema for `ip`

Optional:

- **accesslist** (List of String) Contains entries that identify traffic that may access your content upon passing a threat assessment.
- **blacklist** (List of String) Contains entries that identify traffic that will be blocked or for which an alert will be generated.
- **whitelist** (List of String) Contains entries that identify traffic that may access your content without undergoing threat assessment.


<a id="nestedblock--referer"></a>
### Nested Schema for `referer`

Optional:

- **accesslist** (List of String) Contains entries that identify traffic that may access your content upon passing a threat assessment.
- **blacklist** (List of String) Contains entries that identify traffic that will be blocked or for which an alert will be generated.
- **whitelist** (List of String) Contains entries that identify traffic that may access your content without undergoing threat assessment.


<a id="nestedblock--url"></a>
### Nested Schema for `url`

Optional:

- **accesslist** (List of String) Contains entries that identify traffic that may access your content upon passing a threat assessment.
- **blacklist** (List of String) Contains entries that identify traffic that will be blocked or for which an alert will be generated.
- **whitelist** (List of String) Contains entries that identify traffic that may access your content without undergoing threat assessment.


<a id="nestedblock--user_agent"></a>
### Nested Schema for `user_agent`

Optional:

- **accesslist** (List of String) Contains entries that identify traffic that may access your content upon passing a threat assessment.
- **blacklist** (List of String) Contains entries that identify traffic that will be blocked or for which an alert will be generated.
- **whitelist** (List of String) Contains entries that identify traffic that may access your content without undergoing threat assessment.


