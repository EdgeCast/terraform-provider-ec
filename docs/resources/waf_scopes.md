---
page_title: "edgecast_waf_scopes Resource"
subcategory: "Web Application Firewall (WAF)"
description: |-
  edgecast_waf_scopes Resource
---

# edgecast_waf_scopes Resource
A Security Application Manager configuration:

* Identifies the set of traffic to which it applies by hostname, a URL path, or both.
* Defines how threats will be detected through access rules, rate rules, bot rules, custom rules, and managed rules.
* Identifies how the above rules are enforced on rate limited requests or threats . 
* Keeps your applications secure while auditing new access rules, custom rule, and managed rule configurations.

[Learn more.](https://docs.edgecast.com/cdn/#Web-Security/SAM.htm)

-> You may manage an existing Security Application Manager configuration by importing it as a resource.  
[Learn more.](#import-resource)

## Authentication

This resource requires a [REST API token](../guides/authentication#rest-api-token).

## Example Usage

```terraform
resource "edgecast_waf_scopes" "scopes1" {
  account_number = "0001"

  scope {
    host {
      is_case_insensitive = false
      type                = "EM"
      values              = ["site1.com/path1","site2.com"]
    }

    limit {
      id                   = "<Rate Rule ID #1>"
      name = "limit action custom"
      duration_sec         = 60
      enf_type             = "CUSTOM_RESPONSE"
      status               = 404
      response_body_base64 = "SGVsbG8sIHdvcmxkIQo="
      response_headers = {
        "header1" = "val1"
        "header2" = "val2"
        "header3" = "val4"
      }
    }

    limit {
      id           = "<Rate Rule ID #2>"
      name          = "limit action drop request"
      duration_sec = 10
      enf_type     = "DROP_REQUEST"
    }

    limit {
      id           = "<Rate Rule ID #3>"
      name = "limit action redirect"
      duration_sec = 10
      enf_type     = "REDIRECT_302"
      url          = "https://mysite.com/redirected2"
    }

    path {
      is_case_insensitive = false
      is_negated          = false
      type                = "GLOB"
      value               = "*"
    }

    acl_audit_action {
      enf_type = "ALERT"
    }

    acl_audit_id = "<Access Rule ID>"

    acl_prod_action {
      name = "acl action"
      enf_type      = "ALERT"
    }

    acl_prod_id = "<Access Rule ID>"

    profile_audit_action {
      enf_type = "ALERT"
    }

    profile_audit_id = "<Managed Rule ID>"

    profile_prod_action {
      name = "managed rule action"
      enf_type             = "CUSTOM_RESPONSE"
      response_body_base64 = "SGVsbG8sIHdvcmxkIQo="
      response_headers = {
        "header1" = "val1"
        "header2" = "val2"
        "header3" = "val3"
      }
      status = 404
    }

    profile_prod_id = "<Managed Rule ID>"

    rules_audit_action {
      enf_type = "ALERT"
    }

    rules_audit_id = "<Custom Rule ID>"

    rules_prod_action {
      name = "custom rule action"
      enf_type             = "BLOCK_REQUEST"
    }

    rules_prod_id = "<Custom Rule ID>"

    bots_prod_id = "<Bots Rule ID>"

    bots_prod_action {
      name = "bots action"
      enf_type = "BROWSER_CHALLENGE"
      valid_for_sec = 60
    }
  }

}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `scope` (Block List, Min: 1) (see [below for nested schema](#nestedblock--scope))

### Optional

- `account_number` (String) Identifies your account. Find your account number in the upper right-hand corner of the MCC.

### Read-Only

- `id` (String) The ID of this resource.

<a id="nestedblock--scope"></a>
### Nested Schema for `scope`

Optional:

- `acl_audit_action` (Block Set, Max: 1) Describes the type of action that will take place when the access rule defined within the `acl_audit_id` argument is violated. (see [below for nested schema](#nestedblock--scope--acl_audit_action))
- `acl_audit_id` (String) Indicates the system-defined ID for the access rule that will audit production traffic for this Security Application Manager configuration.
- `acl_prod_action` (Block Set, Max: 1) Describes the type of action that will take place when the access rule defined within the `acl_prod_id` argument is violated. (see [below for nested schema](#nestedblock--scope--acl_prod_action))
- `acl_prod_id` (String) Indicates the system-defined ID for the access rule that will be applied to production traffic for this Security Application Manager configuration.
- `bots_prod_action` (Block Set, Max: 1) Describes the browser challenge that will be applied to requests that satisfy the bot rule set defined within the `bot_prod_id` argument. (see [below for nested schema](#nestedblock--scope--bots_prod_action))
- `bots_prod_id` (String) Indicates the system-defined ID for the bots rule that will be applied to production traffic for this Security Application Manager configuration.
- `host` (Block Set, Max: 1) Describes a hostname match condition. (see [below for nested schema](#nestedblock--scope--host))
- `limit` (Block List) Identifies the set of rate rules that will be enforced for this Security Application Manager configuration and the enforcement action that will be applied to rate limited requests. (see [below for nested schema](#nestedblock--scope--limit))
- `name` (String) Indicates the name assigned to the Security Application Manager configuration.  
**Default Value:** `name`
- `path` (Block Set, Max: 1) Describes a URL path match condition. (see [below for nested schema](#nestedblock--scope--path))
- `profile_audit_action` (Block Set, Max: 1) Describes the type of action that will take place when the managed rule defined within the `profile_audit_id` property is violated. (see [below for nested schema](#nestedblock--scope--profile_audit_action))
- `profile_audit_id` (String) Indicates the system-defined ID for the managed rule that will audit production traffic for this Security Application Manager configuration.
- `profile_prod_action` (Block Set, Max: 1) Describes the type of action that will take place when the managed rule defined within the `profile_prod_id` property is violated. (see [below for nested schema](#nestedblock--scope--profile_prod_action))
- `profile_prod_id` (String) Indicates the system-defined ID for the managed rule that will be applied to production traffic for this Security Application Manager configuration.
- `rules_audit_action` (Block Set, Max: 1) Describes the type of action that will take place when the custom rule set defined within the `rules_audit_id` property is violated. (see [below for nested schema](#nestedblock--scope--rules_audit_action))
- `rules_audit_id` (String) Indicates the system-defined ID for the custom rule set that will audit production traffic for this Security Application Manager configuration.
- `rules_prod_action` (Block Set, Max: 1) Describes the type of action that will take place when the custom rule set defined within the `rules_prod_id` property is violated. (see [below for nested schema](#nestedblock--scope--rules_prod_action))
- `rules_prod_id` (String) Indicates the system-defined ID for the custom rule set that will be applied to production traffic for this Security Application Manager configuration.

<a id="nestedblock--scope--acl_audit_action"></a>
### Nested Schema for `scope.acl_audit_action`

Required:

- `enf_type` (String) Set to `ALERT`. This indicates that malicious traffic will be audited.

Optional:

- `name` (String) Indicates the name assigned to this enforcement action configuration.


<a id="nestedblock--scope--acl_prod_action"></a>
### Nested Schema for `scope.acl_prod_action`

Required:

- `enf_type` (String) Indicates the enforcement action that will be applied to malicious traffic. Valid values are: 
 * `BLOCK_REQUEST` - Block request 
 * `ALERT` - Alert only 
 * `REDIRECT_302` - Redirect (HTTP 302) 
 * `CUSTOM_RESPONSE` - Custom response

Optional:

- `name` (String) Indicates the name assigned to this enforcement action configuration.
- `response_body_base64` (String) **acl_prod_action.type=CUSTOM_RESPONSE:** Indicates the response body that will be sent to malicious traffic. This value is Base64 encoded.
- `response_headers` (Map of String)
- `status` (Number) **acl_prod_action.type=CUSTOM_RESPONSE:** Indicates the HTTP status code (e.g., 404) for the custom response that will be sent to malicious traffic.
- `url` (String) **acl_prod_action.type=REDIRECT_302:** Indicates the URL to which malicious requests will be redirected.
- `valid_for_sec` (Number) Reserved for future use.


<a id="nestedblock--scope--bots_prod_action"></a>
### Nested Schema for `scope.bots_prod_action`

Required:

- `enf_type` (String) Set this property to `BROWSER_CHALLENGE`.

Optional:

- `name` (String) Indicates the name assigned to this enforcement action configuration.
- `response_body_base64` (String) Reserved for future use.
- `response_headers` (Map of String) Reserved for future use.
- `status` (Number) Indicates the HTTP status code (e.g., 404) for the response provided to clients that are being served the browser challenge.
- `url` (String) Reserved for future use.
- `valid_for_sec` (Number) Indicates the number of minutes for which our CDN will serve content to a client that solves a browser challenge without requiring an additional browser challenge to be solved. Specify a value between 1 and 1,440 minutes.


<a id="nestedblock--scope--host"></a>
### Nested Schema for `scope.host`

Required:

- `type` (String) Indicates how the system will interpret the comparison between the request's hostname and the value defined within the `value`/`values` argument. Valid values are: 
 * `EM` - Indicates that request's hostname must be an exact match to one of the case-sensitive values specified in the `values` argument. 
 * `GLOB` - Indicates that the request's hostname must be an exact match to the wildcard pattern defined in the `value` argument. 
 * `RX` - Indicates that the request's hostname must be an exact match to the regular expression defined in the `value` argument. 

    ->Apply this Security Application Manager configuration across all hostnames by setting this argument to `GLOB` and setting the `value` argument to `*`. This type of configuration is also known as `Default`.

Optional:

- `is_case_insensitive` (Boolean) Indicates whether the comparison between the requested hostname and the `values` argument is case-sensitive. Valid values are: 

        True | False
- `is_negated` (Boolean) Indicates whether this match condition will be satisfied when the requested hostname matches or does not match the value defined by the `value`/`values` argument. Valid values are: 

        True | False
- `value` (String) **host.type=GLOB or RX:** Identifies a value that will be used to identify requests that are eligible for this Security Application Manager configuration.
- `values` (List of String) **host.type=EM:** Identifies one or more values used to identify requests that are eligible for this Security Application Manager configuration.


<a id="nestedblock--scope--limit"></a>
### Nested Schema for `scope.limit`

Required:

- `duration_sec` (Number) Indicates the length of time, in seconds, that the action defined within this object will be applied to a client that violates the rate rule identified by the `id` argument. Valid values are: 

        10 | 60 | 300
- `enf_type` (String) Indicates the type of action that will be applied to rate limited requests. Valid values are: 
 * `ALERT` - Alert only 
 * `REDIRECT_302` - Redirect (HTTP 302) 
 * `CUSTOM_RESPONSE` - Custom response 
 * `DROP_REQUEST` - Drop request (503 Service Unavailable response with a retry-after of 10 seconds)
- `id` (String) Indicates the system-defined ID for the rate rule that will be applied to this Security Application Manager configuration.

Optional:

- `name` (String) Indicates the name assigned to this enforcement action.
- `response_body_base64` (String) **limit.enf_type=CUSTOM_RESPONSE:** Indicates the response body that will be sent to rate limited requests. This value is Base64 encoded.
- `response_headers` (Map of String) **limit.enf_type=CUSTOM_RESPONSE:** Contains the set of headers that will be included in the response sent to rate limited requests. Set each desired response header as an argument.
- `status` (Number) **limit.enf_type=CUSTOM_RESPONSE:** Indicates the HTTP status code (e.g., 404) for the custom response sent to rate limited requests.
- `url` (String) **limit.enf_type=REDIRECT_302:** Indicates the URL to which rate limited requests will be redirected.


<a id="nestedblock--scope--path"></a>
### Nested Schema for `scope.path`

Required:

- `type` (String) Indicates how the system will interpret the comparison between the request's URL and the value defined within the `value`/`values` argument. Valid values are: 
 * `EM` - Indicates that request's URL path must be an exact match to one of the case-sensitive values specified in the `values` argument.
 * `GLOB` - Indicates that the request's URL path must be an exact match to the wildcard pattern defined in the `value` argument. 
 * `RX` - Indicates that the request's URL path must be an exact match to the regular expression defined in the `value` argument. 

    ->Apply this Security Application Manager configuration across all URLs by setting this argument to `GLOB` and setting the `value` argument to `*`. This type of configuration is also known as `Default`.

Optional:

- `is_case_insensitive` (Boolean) **path.type=EM:** Indicates whether the comparison between the requested URL and the `values` argument is case-sensitive. Valid values are: 

        True | False
- `is_negated` (Boolean) Indicates whether this match condition will be satisfied when the requested URL matches or does not match the value defined by the `value`/`values` argument. Valid values are: 

        True | False
- `value` (String) **path.type=GLOB|RX:** Identifies a value that will be used to identify requests that are eligible for this Security Application Manager configuration. Specify a URL path pattern that starts directly after the hostname.
- `values` (List of String) **path.type=EM:** Identifies one or more values used to identify requests that are eligible for this Security Application Manager configuration. Specify a URL path pattern that starts directly after the hostname.


<a id="nestedblock--scope--profile_audit_action"></a>
### Nested Schema for `scope.profile_audit_action`

Required:

- `enf_type` (String) Set to `ALERT`. This indicates that malicious traffic will be audited.

Optional:

- `name` (String) Indicates the name assigned to this enforcement action configuration.


<a id="nestedblock--scope--profile_prod_action"></a>
### Nested Schema for `scope.profile_prod_action`

Required:

- `enf_type` (String) Indicates the enforcement action that will be applied to malicious traffic. Valid values are: 
 * `BLOCK_REQUEST` - Block Request 
 * `ALERT` - Alert Only 
 * `REDIRECT_302` - Redirect (HTTP 302) 
 * `CUSTOM_RESPONSE` - Custom Response

Optional:

- `name` (String) Indicates the name assigned to this enforcement action configuration.
- `response_body_base64` (String) **enf_type: CUSTOM_RESPONSE Only:** Indicates the response body that will be sent to malicious traffic. This value is Base64 encoded.
- `response_headers` (Map of String) **enf_type: CUSTOM_RESPONSE Only:** Indicates the set of response headers that will be sent to malicious traffic. 

    ->Each response header is specified as a name/value pair.
- `status` (Number) **enf_type: CUSTOM_RESPONSE Only:** Indicates the HTTP status code (e.g., 404) for the custom response that will be sent to malicious traffic.
- `url` (String) **enf_type: CUSTOM_RESPONSE Only:** Indicates the URL to which malicious requests will be redirected.
- `valid_for_sec` (Number) Reserved for future use.


<a id="nestedblock--scope--rules_audit_action"></a>
### Nested Schema for `scope.rules_audit_action`

Required:

- `enf_type` (String) Set to `ALERT`. This indicates that malicious traffic will be audited.

Optional:

- `name` (String) Indicates the name assigned to this enforcement action configuration.


<a id="nestedblock--scope--rules_prod_action"></a>
### Nested Schema for `scope.rules_prod_action`

Required:

- `enf_type` (String) Indicates the enforcement action that will be applied to malicious traffic. Valid values are: 
 * `BLOCK_REQUEST` - Block Request 
 * `ALERT` - Alert Only 
 * `REDIRECT_302` - Redirect (HTTP 302) 
 * `CUSTOM_RESPONSE` - Custom Response

Optional:

- `name` (String) Indicates the name assigned to this enforcement action configuration.
- `response_body_base64` (String) **enf_type: CUSTOM_RESPONSE Only:** Indicates the response body that will be sent to malicious traffic. This value is Base64 encoded.
- `response_headers` (Map of String) **enf_type: CUSTOM_RESPONSE Only:** Indicates the set of response headers that will be sent to malicious traffic. 

    ->Each response header is specified as a name/value pair.
- `status` (Number) **enf_type: CUSTOM_RESPONSE Only:** Indicates the HTTP status code (e.g., 404) for the custom response that will be sent to malicious traffic.
- `url` (String) **enf_type: CUSTOM_RESPONSE Only:** Indicates the URL to which malicious requests will be redirected.
- `valid_for_sec` (Number) Reserved for future use.

## Import Resource
Manage an existing Security Application Manager configuration through Terraform by importing it as a resource. Perform the following steps:
1. Insert an empty resource block within your resource configuration.

        resource "edgecast_waf_scopes" "<RESOURCE>" {
          
        }
    **Example:**

        resource "edgecast_waf_scopes" "sample_sam" {
          
        }
1. Run the following command to attach an Security Application Manager configuration to your resource configuration.

        terraform import edgecast_waf_scopes.<RESOURCE> <ACCOUNT_NUMBER>:<SAM_ID>
    * `<RESOURCE>` - Replace this term with the name of the resource defined in step 1.
    * `<ACCOUNT_NUMBER>` - Replace this term with your customer account number. Find your account number in the upper right-hand corner of the MCC.
    * `<SAM_ID>` - Replace this term with the system-defined ID assigned to the desired Security Application Manager configuration. You may retrieve a list of Security Application Manager configurations and their system-defined IDs through our [REST API](https://developer.edgecast.com/cdn/api/index.html#Media_Management/Web-Security/Get-All-Scopes.htm).

    **Example:**

        terraform import edgecast_waf_scopes.sample_sam 0001:123456
->Upon running the above command, a resource for that Security Application Manager configuration will be recorded in the state file.
