---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "ec_waf_scopes Resource - terraform-provider-ec"
subcategory: ""
description: |-
  
---

# ec_waf_scopes (Resource)

## Example Usage

```terraform
resource "ec_waf_scopes" "scopes1" {
  account_number = var.account_number

  scope {
    name           = "Scopes Test"
    
    host {
      is_case_insensitive = false
      type                = "EM"
      values              = ["site1.com/path1","site2.com"]
    }

    limit {
      id                   = "<Rate Rule ID #1>"
      duration_sec         = 60
      enf_type             = "CUSTOM_RESPONSE"
      name                 = "limit 1 custom response"
      status               = 404
      response_body_base64 = "SGVsbG8sIHdvcmxkIQo="
      response_headers = {
        "header1" = "val1"
        "header2" = "val1"
      }
    }

    limit {
      id           = "<Rate Rule ID #2>"
      duration_sec = 300
      enf_type     = "DROP_REQUEST"
      name         = "limit 2 drop request"
    }

    limit {
      id           = "<Rate Rule ID #3>"
      duration_sec = 10
      enf_type     = "REDIRECT_302"
      name         = "limit 3 redirect"
      url          = "https://mysite.com/redirected"
    }

    path {
      is_case_insensitive = false
      is_negated          = false
      type                = "GLOB"
      value               = "*"
    }

    acl_audit_action {
      name = "audit action"
      type = "ALERT"
    }

    acl_audit_id = "<Access Rule ID>"

    acl_prod_action {
      valid_for_sec = 60
      enf_type      = "ALERT"
    }

    acl_prod_id = "<Access Rule ID>"

    profile_audit_action {
      name = "profile action"
      type = "ALERT"
    }

    profile_audit_id = "<Managed Rule ID>"

    profile_prod_action {
      valid_for_sec        = 60
      enf_type             = "CUSTOM_RESPONSE"
      name                 = "profile action"
      response_body_base64 = "SGVsbG8sIHdvcmxkIQo="
      response_headers = {
        "header1" = "val1"
        "header2" = "val1"
      }
      status = 404
    }

    profile_prod_id = "<Managed Rule ID>"

    rule_audit_action {
      name = "custom rule action"
      type = "ALERT"
    }

    rule_audit_id = "<Custom Rule ID>"

    rule_prod_action {
      valid_for_sec        = 60
      enf_type             = "BLOCK_REQUEST"
      name                 = "profile action"
    }

    rule_prod_id = "<Custom Rule ID>"
  }

}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- **scope** (Block List, Min: 1) (see [below for nested schema](#nestedblock--scope))

### Optional

- **account_number** (String) Identifies your account by its customer account number.
- **id** (String) The ID of this resource.

<a id="nestedblock--scope"></a>
### Nested Schema for `scope`

Optional:

- **acl_audit_action** (Block Set, Max: 1) Describe the type of action that will take place when the access rule defined within the acl_audit_id property is violated. Refer to the Audit Action section for property details. (see [below for nested schema](#nestedblock--scope--acl_audit_action))
- **acl_audit_id** (String) Indicates the system-defined ID for the access rule that will audit production traffic for this Security Application Manager configuration.
- **acl_prod_action** (Block Set, Max: 1) Describes the type of action that will take place when the access rule defined within the acl_prod_id property is violated. Refer to the Prod Action section for property details. (see [below for nested schema](#nestedblock--scope--acl_prod_action))
- **acl_prod_id** (String) Indicates the system-defined ID for the access rule that will be applied to production traffic for this Security Application Manager configuration.
- **bots_prod_action** (Block Set, Max: 1) Describes the type of action that will take place when the bots rule defined within the bots_prod_id property is violated. Refer to the Prod Action section for property details. (see [below for nested schema](#nestedblock--scope--bots_prod_action))
- **bots_prod_id** (String) Indicates the system-defined ID for the bots rule that will be applied to production traffic for this Security Application Manager configuration.
- **host** (Block Set, Max: 1) Describes a hostname match condition. Refer to the URL and Path section for property details. (see [below for nested schema](#nestedblock--scope--host))
- **limit** (Block List) (see [below for nested schema](#nestedblock--scope--limit))
- **name** (String) Indicates the name assigned to the Security Application Manager configuration. Default Value: 'name'
- **path** (Block Set, Max: 1) Describes a URL match condition.Refer to the URL and Path section for property details. (see [below for nested schema](#nestedblock--scope--path))
- **profile_audit_action** (Block Set, Max: 1) Describes the type of action that will take place when the managed rule defined within the profile_audit_id property is violated. Refer to the Audit Action  section for property details. (see [below for nested schema](#nestedblock--scope--profile_audit_action))
- **profile_audit_id** (String) Indicates the system-defined ID for the managed rule that will audit production traffic for this Security Application Manager configuration.
- **profile_prod_action** (Block Set, Max: 1) Describes the type of action that will take place when the managed rule defined within the profile_prod_id property is violated. Refer to the Prod Action section for property details. (see [below for nested schema](#nestedblock--scope--profile_prod_action))
- **profile_prod_id** (String) Indicates the system-defined ID for the managed rule that will be applied to production traffic for this Security Application Manager configuration.
- **rule_audit_action** (Block Set, Max: 1) Describes the type of action that will take place when the custom rule set defined within the rule_audit_id property is violated. Refer to the Audit Action section for property details. (see [below for nested schema](#nestedblock--scope--rule_audit_action))
- **rule_audit_id** (String) Indicates the system-defined ID for the custom rule set that will audit production traffic for this Security Application Manager configuration.
- **rule_prod_action** (Block Set, Max: 1) Describes the type of action that will take place when the custom rule set defined within the rule_prod_id property is violated. Refer to the Prod Action section for property details. (see [below for nested schema](#nestedblock--scope--rule_prod_action))
- **rule_prod_id** (String) Indicates the system-defined ID for the custom rule set that will be applied to production traffic for this Security Application Manager configuration.

<a id="nestedblock--scope--acl_audit_action"></a>
### Nested Schema for `scope.acl_audit_action`

Required:

- **type** (String)

Optional:

- **name** (String)


<a id="nestedblock--scope--acl_prod_action"></a>
### Nested Schema for `scope.acl_prod_action`

Required:

- **enf_type** (String)
- **valid_for_sec** (Number)

Optional:

- **name** (String)
- **response_body_base64** (String)
- **response_headers** (Map of String)
- **status** (Number)
- **url** (String)


<a id="nestedblock--scope--bots_prod_action"></a>
### Nested Schema for `scope.bots_prod_action`

Required:

- **enf_type** (String)
- **valid_for_sec** (Number)

Optional:

- **name** (String)
- **response_body_base64** (String)
- **response_headers** (Map of String)
- **status** (Number)
- **url** (String)


<a id="nestedblock--scope--host"></a>
### Nested Schema for `scope.host`

Required:

- **type** (String)

Optional:

- **is_case_insensitive** (Boolean)
- **is_negated** (Boolean)
- **value** (String)
- **values** (List of String)


<a id="nestedblock--scope--limit"></a>
### Nested Schema for `scope.limit`

Required:

- **duration_sec** (Number) Indicates the length of time, in seconds, that the action defined within this object will be applied to a client that violates the rate rule identified by the id property.\
\
Valid values are: 10 | 60 | 300
- **enf_type** (String) Indicates the type of action that will be applied to rate limited requests.\
\
Valid values are:ALERT: Alert OnlyREDIRECT_302: Redirect (HTTP 302)CUSTOM_RESPONSE: Custom ResponseDROP_REQUEST: Drop Request (503 Service Unavailable response with a retry-after of 10 seconds)
- **id** (String) Indicates the system-defined ID for the rate limit configuration that will be applied to this Security Application Manager configuration.

Optional:

- **name** (String) Indicates the name assigned to this enforcement action.
- **response_body_base64** (String) Note: Only valid when ENFType is set to CUSTOM_RESPONSE \
\
Indicates the response body that will be sent to rate limited requests. This value is Base64 encoded.
- **response_headers** (Map of String) Note: Only valid when ENFType is set to CUSTOM_RESPONSE\
\
Contains the set of headers that will be included in the response sent to rate limited requests.
- **status** (Number) Note: Only valid when ENFType is set to CUSTOM_RESPONSE\
\
Indicates the HTTP status code (e.g., 404) for the custom response sent to rate limited requests.
- **url** (String) Note: Only valid when ENFType is set to REDIRECT_302\
\
Indicates the URL to which rate limited requests will be redirected.


<a id="nestedblock--scope--path"></a>
### Nested Schema for `scope.path`

Required:

- **type** (String)

Optional:

- **is_case_insensitive** (Boolean)
- **is_negated** (Boolean)
- **value** (String)
- **values** (List of String)


<a id="nestedblock--scope--profile_audit_action"></a>
### Nested Schema for `scope.profile_audit_action`

Required:

- **type** (String)

Optional:

- **name** (String)


<a id="nestedblock--scope--profile_prod_action"></a>
### Nested Schema for `scope.profile_prod_action`

Required:

- **enf_type** (String)
- **valid_for_sec** (Number)

Optional:

- **name** (String)
- **response_body_base64** (String)
- **response_headers** (Map of String)
- **status** (Number)
- **url** (String)


<a id="nestedblock--scope--rule_audit_action"></a>
### Nested Schema for `scope.rule_audit_action`

Required:

- **type** (String)

Optional:

- **name** (String)


<a id="nestedblock--scope--rule_prod_action"></a>
### Nested Schema for `scope.rule_prod_action`

Required:

- **enf_type** (String)
- **valid_for_sec** (Number)

Optional:

- **name** (String)
- **response_body_base64** (String)
- **response_headers** (Map of String)
- **status** (Number)
- **url** (String)





## Host and Path
### Required
- **type** (String) Indicates how the system will interpret the comparison 
between the request's hostname or the URL Path and the value defined within the
Value/Values property.

Valid values are:
    - EM: Indicates that request hostname or URL Path must be an exact match
    to one of the case-sensitive values specified in the values property.
    - GLOB: Indicates that the request hostname or URL Path must be an exact
    match to the wildcard pattern defined in the value property.
    - RX: Indicates that the request hostname or URL Path must be an exact
    match to the regular expression defined in the value property.

Note: Apply this Security Application Manager configuration across
all hostnames or URLs by setting this property to "GLOB" and setting
the Value property to "*." This type of configuration is also known as
"Default."

### Optional
- **is_case_insensitive** (Boolean) Indicates whether the comparison between the
requested hostname or URL Path and the values property is case-sensitive.
    Valid values are:
	    True: Case-insensitive
	    False: Case-sensitive
Indicates whether the comparison btween the requested hostname or URL

- **is_negated** (Boolean) Indicates whether this match condition will be 
satisfied when the requested hostname or URL Path matches or does not match the
Value defined by the Value/Values property.
	Valid values are:
		True: Does not match
		False: Matches

- **value** (String) Identifies a value that will be used to identify requests 
that are eligible for this Security Application Manager configuration.

Note: Only valid when Type is set to GLOB or RX

- **values** (List of String) Identifies one or more values used to identify 
requests that are eligible for this Security Application Manager configuration.

Note: Only valid when Type is set to EM

## Audit Actions
### Required
- **type** (String) Set to ALERT. This indicates that malicious traffic will be 
audited.
### Optional
- **name** (String) Indicates the name assigned to this enforcement action 
configuration.

## Prod Actions
### Required
- **enf_type** (String) Indicates the enforcement action that will be applied to 
malicious traffic.

Valid values are:
    - BLOCK_REQUEST: Block Request
    - ALERT: Alert Only
    - REDIRECT_302: Redirect (HTTP 302)
    - CUSTOM_RESPONSE: Custom Response
    - BROWSER_CHALLENGE: Browser Challenge (only valid for Bot Rules)

### Optional
- **name** (String) Indicates the name assigned to this enforcement action 
configuration.
- **response_body_base64** (String) Indicates the response body that will be 
sent to malicious traffic. This value is Base64 encoded.
Note: Only valid when ENFType is set to CUSTOM_RESPONSE

- **response_headers** (Map) Indicates the set of response headers that will be 
sent to malicious traffic.
Note: Only valid when ENFType is set to CUSTOM_RESPONSE

- **status** (Number) Indicates the HTTP status code (e.g., 404) for the custom 
response that will be sent to malicious traffic.
Note: Only valid when ENFType is set to CUSTOM_RESPONSE or BROWSER_CHALLENGE

- **url** (String) Indicates the URL to which malicious requests will be 
redirected.
Note: Only valid when ENFType is set to REDIRECT_302

- **valid_for_sec** (Number) Indicates the length of time in seconds that a 
browser challenge success cookie remains valid. This cookie is assigned when the 
user solves the challenge and prevents further challenges.
Note: Only valid when ENFType is set to BROWSER_CHALLENGE