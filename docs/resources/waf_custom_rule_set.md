---
page_title: "edgecast_waf_custom_rule_set Resource"
subcategory: "Web Application Firewall (WAF)"
description: |-
  edgecast_waf_custom_rule_set Resource
---

# edgecast_waf_custom_rule_set Resource
Use custom rules to tailor how WAF identifies malicious traffic. This provides added flexibility for threat identification that allows you to target malicious traffic with minimal impact to legitimate traffic. 

-> Apply a custom rule set to your traffic by adding it to a [Security Application Manager](https://docs.edgecast.com/cdn/#Web-Security/SAM.htm) configuration.

-> You may manage an existing custom rule set by importing it as a resource.  
[Learn more.](#import-resource)

## Example Usage

```terraform
resource "edgecast_waf_custom_rule_set" "custom_rule_1" {
  account_number = "0001"
  name        = "Custom Rule Set 1"

  directive {
    sec_rule {
      name = "Sec Rule 1"
      action {
        id              = 66000000
        msg             = "Invalid user agent."
        transformations = ["NONE"]
      }
      operator {
        is_negated = false
        type       = "CONTAINS"
        value      = "bot"
      }
      variable {
        is_count = false
        match {
          is_negated = false
          is_regex   = false
          value      = "User-Agent"
        }
        match {
          is_negated = false
          is_regex   = false
          value      = "User-Agent"
        }
        type = "REQUEST_HEADERS"
      }
      variable {
        is_count = false
        match {
          is_negated = false
          is_regex   = false
          value      = "User-Agent"
        }
        type = "REQUEST_URI"
      }
      chained_rule {
        action {
          transformations = ["NONE"]
        }
        operator {
          is_negated = false
          type       = "CONTAINS"
          value      = "bot"
        }
        variable {
          is_count = false
          match {
            is_negated = false
            is_regex   = false
            value      = "User-Agent"
          }
          match {
            is_negated = false
            is_regex   = false
            value      = "User-Agent"
          }
          type = "REQUEST_HEADERS"
        }
      }
    }
  }
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `account_number` (String) Identifies your account. Find your account number in the upper right-hand corner of the MCC.
- `directive` (Block Set, Min: 1) Contains custom rules. Each directive object defines a custom rule via the `sec_rule` block. 

    ->You may create up to 10 custom rules. (see [below for nested schema](#nestedblock--directive))

### Optional

- `name` (String) Assigns a name to this custom rule.

### Read-Only

- `id` (String) Indicates the system-defined ID for the custom rule set.
- `last_modified_date` (String) Indicates the date and time at which the custom rule was last modified.

<a id="nestedblock--directive"></a>
### Nested Schema for `directive`

Required:

- `sec_rule` (Block Set, Min: 1, Max: 1) The `sec_rule` block describes a custom rule. (see [below for nested schema](#nestedblock--directive--sec_rule))

<a id="nestedblock--directive--sec_rule"></a>
### Nested Schema for `directive.sec_rule`

Required:

- `action` (Block Set, Min: 1) Determines whether the string identified in the `variable.type` argument will be transformed and the metadata that will be assigned to malicious traffic. (see [below for nested schema](#nestedblock--directive--sec_rule--action))
- `operator` (Block Set, Min: 1, Max: 1) Indicates the comparison that will be performed against the request element(s) identified within a `variable` block. (see [below for nested schema](#nestedblock--directive--sec_rule--operator))
- `variable` (Block List, Min: 1) Contains criteria that identifies a request element. (see [below for nested schema](#nestedblock--directive--sec_rule--variable))

Optional:

- `chained_rule` (Block List) Each block within the `chained_rule` argument describes an additional set of criteria that must be satisfied in order to identify a malicious request. (see [below for nested schema](#nestedblock--directive--sec_rule--chained_rule))
- `name` (String) Indicates the name assigned to this custom rule.

<a id="nestedblock--directive--sec_rule--action"></a>
### Nested Schema for `directive.sec_rule.action`

Optional:

- `id` (String) Determines the custom ID that will be assigned to this custom rule. This custom ID is exposed via the Threats Dashboard.  
Valid values fall within this range: `66000000 - 66999999`  
**Default Value:** Random number 

    ->This argument is only applicable for the `action` block defined within the root of the `sec_rule` block.
- `msg` (String) Determines the rule message that will be assigned to this custom rule. This message is exposed via the Threats Dashboard.  
**Default Value:** Blank 

    ->This argument is only applicable for the `action` block defined within the root of the `sec_rule` block.
- `transformations` (List of String) Determines the set of transformations that will be applied to the value derived from the request element identified in a `variable` block (i.e., source value). Transformations are always applied to the source value, regardless of the number of transformations that have been defined.  Valid values are: 
 * `NONE` - Indicates that the source value should not be modified.
 * `LOWERCASE` - Indicates that the source value should be converted to lowercase characters.
 * `URLDECODE` - Indicates that the source value should be URL decoded. This transformation is useful when the source value has been URL encoded twice.
 * `REMOVENULLS` - Indicates that null values should be removed from the source value.

    ->A criterion is satisfied if the source value or any of the modified string values meet the conditions defined within the `operator` block.


<a id="nestedblock--directive--sec_rule--operator"></a>
### Nested Schema for `directive.sec_rule.operator`

Required:

- `type` (String) Indicates how the system will interpret the comparison between the `value` argument and the value derived from the request element defined within a `variable` block. Valid values are: 
 * `RX` - Indicates that the string value derived from the request element must satisfy the regular expression defined in the `value` argument. 
 * `STREQ` - Indicates that the string value derived from the request element must be an exact match to the `value` argument. 
 * `CONTAINS` - Indicates that the `value` argument must contain the string value derived from the request element. 
 * `BEGINSWITH` - Indicates that the `value` argument must start with the string value derived from the request element. 
 * `ENDSWITH` -  Indicates that the `value` argument must end with the string value derived from the request element. 
 * `EQ` - Indicates that the number derived from the `variable` block must be an exact match to the `value` argument.  

    ->You should only use `EQ` when the `is_count` argument has been enabled. 
 * `IPMATCH` - Requires that the request's IP address either be contained by an IP block or be an exact match to an IP address defined in the `values` argument. Only use `IPMATCH` with the `REMOTE_ADDR` variable.

Optional:

- `is_negated` (Boolean) Indicates whether a condition will be satisfied when the value derived from the request element defined within a `variable` block matches or does not match the `value` argument. Valid values are: 
 * `True` - Does not match 
 * `False` - Matches
- `value` (String) Indicates a value that will be compared against the string or number value derived from the request element defined within a `variable` block.  
**Sample values:** `/marketing` and `/800001/myorigin`  

    ->If you are identifying traffic via a URL path (`REQUEST_URI`), then you should specify a URL path pattern that starts directly after the hostname. Exclude a protocol or a hostname when defining this argument.


<a id="nestedblock--directive--sec_rule--variable"></a>
### Nested Schema for `directive.sec_rule.variable`

Required:

- `type` (String) Determines the request element that will be assessed. Valid values are: 

        ARGS_POST | GEO | QUERY_STRING | REMOTE_ADDR | REQUEST_BODY | REQUEST_COOKIES | REQUEST_HEADERS | REQUEST_METHOD | REQUEST_URI  

    ->If a request element consists of one or more key-value pairs, then you may identify a key via a match object. If is_count has been disabled, then you may identify a specific value via the `operator` block.

Optional:

- `is_count` (Boolean) Determines whether a comparison will be performed between the `operator` block and a string value or the number of matches found. Valid values are: 
 * `true` - A counter will increment whenever the request element defined by this `variable` block is found. The `operator` block will perform a comparison against this number.  

    ->If you enable the `is_count` argument, then you must also set the `type` argument to `EQ`. 
 * `false` - The `operator` block will perform a comparison against the string value derived from the request element defined by this `variable` block.
- `match` (Block List) The `match` block determines the comparison conditions for the request element identified by the `type` argument. (see [below for nested schema](#nestedblock--directive--sec_rule--variable--match))

<a id="nestedblock--directive--sec_rule--variable--match"></a>
### Nested Schema for `directive.sec_rule.variable.match`

Optional:

- `is_negated` (Boolean) Determines whether this condition is satisfied when the request element identified by the `variable` block is found or not found. Valid values are: 
 * `True` - Not found 
 * `False` - Found
- `is_regex` (Boolean) Determines whether the `value` argument will be interpreted as a regular expression. Valid values are: 
 * `true` - Regular expression 
 * `false` - Default value. Literal value.
- `value` (String) Restricts the match condition defined by the `type` argument to the specified value.  
**Example:** If the `type` argument is set to `REQUEST_HEADERS` and this argument is set to **User-Agent**, then this match condition is restricted to the User-Agent request header. If the `value` argument is omitted, then this match condition applies to all request headers.



<a id="nestedblock--directive--sec_rule--chained_rule"></a>
### Nested Schema for `directive.sec_rule.chained_rule`

Required:

- `action` (Block Set, Min: 1) Determines whether the string identified in a `variable` block will be transformed and the metadata that will be assigned to malicious traffic. (see [below for nested schema](#nestedblock--directive--sec_rule--chained_rule--action))
- `operator` (Block Set, Min: 1, Max: 1) Indicates the comparison that will be performed against the request element(s) identified within a `variable` block. (see [below for nested schema](#nestedblock--directive--sec_rule--chained_rule--operator))

Optional:

- `variable` (Block List) Contains criteria that identifies a request element. (see [below for nested schema](#nestedblock--directive--sec_rule--chained_rule--variable))

<a id="nestedblock--directive--sec_rule--chained_rule--action"></a>
### Nested Schema for `directive.sec_rule.chained_rule.action`

Optional:

- `transformations` (List of String) Determines the set of transformations that will be applied to the value derived from the request element identified in a `variable` block (i.e., source value). Transformations are always applied to the source value, regardless of the number of transformations that have been defined.  Valid Values are: 
 * `NONE` - Indicates that the source value should not be modified. 
 * `LOWERCASE` - Indicates that the source value should be converted to lowercase characters. 
 * `URLDECODE` - Indicates that the source value should be URL decoded. This transformation is useful when the source value has been URL encoded twice. 
 * `REMOVENULLS` - Indicates that null values should be removed from the source value.

    ->A criterion is satisfied if the source value or any of the modified string values meet the conditions defined within the `operator` block.


<a id="nestedblock--directive--sec_rule--chained_rule--operator"></a>
### Nested Schema for `directive.sec_rule.chained_rule.operator`

Required:

- `type` (String) Indicates how the system will interpret the comparison between the `value` argument and the value derived from the request element defined within a `variable` block. Valid values are: 
 * `RX` - Indicates that the string value derived from the request element must satisfy the regular expression defined in the `value` argument. 
 * `STREQ` - Indicates that the string value derived from the request element must be an exact match to the `value` argument. 
 * `CONTAINS` - Indicates that the `value` argument must contain the string value derived from the request element. 
 * `BEGINSWITH` - Indicates that the `value` argument must start with the string value derived from the request element. 
 * `ENDSWITH` - Indicates that the `value` argument must end with the string value derived from the request element. 
 * `EQ` - Indicates that the number derived from the `variable` block must be an exact match to the `value` argument. 

    ->You should only use EQ when the `is_count` argument has been enabled. 
 * `IPMATCH` - Requires that the request's IP address either be contained by an IP block or be an exact match to an IP address defined in the `values` argument. Only use `IPMATCH` with the `REMOTE_ADDR` variable.

Optional:

- `is_negated` (Boolean) Indicates whether a condition will be satisfied when the value derived from the request element defined within a `variable` block matches or does not match the `value` argument.  Valid values are: 
 * `True` - Does not match 
 * `False` - Matches
- `value` (String) Indicates a value that will be compared against the string or number value derived from the request element defined within a `variable` block.  
**Sample values:** `/marketing` and `/800001/myorigin` 

    ->If you are identifying traffic via a URL path (`REQUEST_URI`), then you should specify a URL path pattern that starts directly after the hostname. Exclude a protocol or a hostname when defining this argument.


<a id="nestedblock--directive--sec_rule--chained_rule--variable"></a>
### Nested Schema for `directive.sec_rule.chained_rule.variable`

Required:

- `type` (String) Determines the request element that will be assessed. Valid values are: 

        ARGS_POST | GEO | QUERY_STRING | REMOTE_ADDR | REQUEST_BODY | REQUEST_COOKIES | REQUEST_HEADERS | REQUEST_METHOD | REQUEST_URI 

    ->If a request element consists of one or more key-value pairs, then you may identify a key via a `match` block. If the `is_count` argument has been disabled, then you may identify a specific value via the `operator` block.

Optional:

- `is_count` (Boolean) Determines whether a comparison will be performed between the `operator` block and a string value or the number of matches found. Valid values are: 
 * `true` - A counter will increment whenever the request element defined by this `variable` block is found. The `operator` block will perform a comparison against this number. 

    ->If you enable the `is_count` argument, then you must also set the `type` argument to `EQ`. 
 * `false` - The `operator` block will perform a comparison against the string value derived from the request element defined by this `variable` block.
- `match` (Block List) The `match` block determines the comparison conditions for the request element identified by the `type` argument. (see [below for nested schema](#nestedblock--directive--sec_rule--chained_rule--variable--match))

<a id="nestedblock--directive--sec_rule--chained_rule--variable--match"></a>
### Nested Schema for `directive.sec_rule.chained_rule.variable.match`

Optional:

- `is_negated` (Boolean) Determines whether this condition is satisfied when the request element identified by the `variable` block is found or not found. Valid values are: 
 * `True` - Not found 
 * `False` - Found
- `is_regex` (Boolean) Determines whether the `value` argument will be interpreted as a regular expression. Valid values are: 
 * `true` - Regular expression 
 * `false` - Default value. Literal value.
- `value` (String) Restricts the match condition defined by the `type` argument to the specified value.  
**Example:** 
If the `type` argument is set to `REQUEST_HEADERS` and this argument is set to `User-Agent`, then this match condition is restricted to the User-Agent request header. If the `value` argument is omitted, then this match condition applies to all request headers.

## Import Resource
Manage an existing custom rule set through Terraform by importing it as a resource. Perform the following steps:
1. Insert an empty resource block within your resource configuration.

        resource "edgecast_waf_custom_rule_set" "<RESOURCE>" {
          
        }
    **Example:**

        resource "edgecast_waf_custom_rule_set" "sample_custom_rule_set" {
          
        }
1. Run the following command to attach an custom rule set to your resource configuration.

        terraform import edgecast_waf_custom_rule_set.<RESOURCE> <ACCOUNT_NUMBER>:<CUSTOM_RULE_SET_ID>
    * `<RESOURCE>` - Replace this term with the name of the resource defined in step 1.
    * `<ACCOUNT_NUMBER>` - Replace this term with your customer account number. Find your account number in the upper right-hand corner of the MCC.
    * `<CUSTOM_RULE_SET_ID>` - Replace this term with the system-defined ID assigned to the desired custom rule set. You may retrieve a list of custom rule sets and their system-defined IDs through our [REST API](https://developer.edgecast.com/cdn/api/index.html#Media_Management/Web-Security/Get-All-Custom-Rule-Sets.htm).

    **Example:**

        terraform import edgecast_waf_custom_rule_set.sample_custom_rule_set 0001:123456
->Upon running the above command, a resource for that custom rule set will be recorded in the state file.