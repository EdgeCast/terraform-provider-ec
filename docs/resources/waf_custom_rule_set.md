---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "edgecast_waf_custom_rule_set Resource - terraform-provider-edgecast"
subcategory: ""
description: |-
  
---

# edgecast_waf_custom_rule_set (Resource)



## Example Usage

```terraform
resource "edgecast_waf_custom_rule_set" "custom_rule_1" {
  customer_id = "<customer_id>"
  name        = "Custom Rule 1"
  
directive {
      sec_rule {
          name = "Sec Rule 1"
          action {
              id = 66000000 
              msg = "Invalid user agent."
              transformations = ["NONE"]
          }
          operator {
              is_negated = false
              type = "CONTAINS"
              value = "bot"
          }
          variable {
              is_count = false
              match {
                is_negated = false
                is_regex = false
                value = "User-Agent"
              } 
              match {
                  is_negated = false
                  is_regex = false
                  value = "User-Agent"
              }
              type = "REQUEST_HEADERS"
          }
          variable {
              is_count = false
              match {
                is_negated = false
                is_regex = false
                value = "User-Agent"
              } 
              type = "REQUEST_URI"
          }
          chained_rule {
                action {
                id = 66000001 
                msg = "Invalid user agent - chained."
                transformations = ["NONE"]
            }
            operator {
                is_negated = false
                type = "CONTAINS"
                value = "bot"
            }
            variable {
                is_count = false
                match {
                    is_negated = false
                    is_regex = false
                    value = "User-Agent"
                } 
                match {
                    is_negated = false
                    is_regex = false
                    value = "User-Agent"
                }
                type = "REQUEST_HEADERS"
            }
          }
        }
    }
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `customer_id` (String) Identifies your account by its customer account number.
- `directive` (Block Set, Min: 1) Contains custom rules. Each directive object defines a custom rule via the sec_rule object \
    Note: You may create up to 10 custom rules. (see [below for nested schema](#nestedblock--directive))

### Optional

- `name` (String) Indicates the name of the custom rule.

### Read-Only

- `id` (String) Indicates the system-defined ID for the custom rule set.
- `last_modified_date` (String) Indicates the date and time at which the custom rule was last modified.

<a id="nestedblock--directive"></a>
### Nested Schema for `directive`

Required:

- `sec_rule` (Block Set, Min: 1, Max: 1) sec_rule object describes a custom rule (see [below for nested schema](#nestedblock--directive--sec_rule))

<a id="nestedblock--directive--sec_rule"></a>
### Nested Schema for `directive.sec_rule`

Required:

- `action` (Block Set, Min: 1) Determines whether the string identified in a variable object will be transformed and the metadata that will be assigned to malicious traffic. (see [below for nested schema](#nestedblock--directive--sec_rule--action))
- `operator` (Block Set, Min: 1, Max: 1) Indicates the comparison that will be performed against the request element(s) identified within a variable object. (see [below for nested schema](#nestedblock--directive--sec_rule--operator))
- `variable` (Block List, Min: 1) Contains criteria that identifies a request element. (see [below for nested schema](#nestedblock--directive--sec_rule--variable))

Optional:

- `chained_rule` (Block List) Each object within the chained_rule array describes an additional set of criteria that must be satisfied in order to identify a malicious request. (see [below for nested schema](#nestedblock--directive--sec_rule--chained_rule))
- `name` (String) Indicates the name assigned to this custom rule.

<a id="nestedblock--directive--sec_rule--action"></a>
### Nested Schema for `directive.sec_rule.action`

Optional:

- `id` (String) Determines the custom ID that will be assigned to this custom rule. This custom ID is exposed via the Threats Dashboard. \
    Valid values fall within this range: 66000000 - 66999999 \
    *Note: This field is only applicable for the action object that resides in the root of the sec_rule object.* \
    Default Value: Random number
- `msg` (String) Determines the rule message that will be assigned to this custom rule. This message is exposed via the Threats Dashboard. \
    *Note: This field is only applicable for the action object that resides in the root of the sec_rule object.* \
    Default Value: Blank
- `transformations` (List of String) Determines the set of transformations that will be applied to the value derived from the request element identified in a variable object (i.e., source value). Transformations are always applied to the source value, regardless of the number of transformations that have been defined.  \
Valid Values are: \
*NONE*: Indicates that the source value should not be modified. \
*LOWERCASE*: Indicates that the source value should be converted to lowercase characters. \
*URLDECODE*: Indicates that the source value should be URL decoded. This transformation is useful when the source value has been URL encoded twice. \
*REMOVENULLS*: Indicates that null values should be removed from the source value. \
*Note: A criterion is satisfied if the source value or any of the modified string values meet the conditions defined by the operator object.*


<a id="nestedblock--directive--sec_rule--operator"></a>
### Nested Schema for `directive.sec_rule.operator`

Required:

- `type` (String) Indicates how the system will interpret the comparison between the value property and the value derived from the request element defined within a variable object.  \
Valid Values are: \
*RX*: Indicates that the string value derived from the request element must satisfy the regular expression defined in the value property. \
*STREQ*: Indicates that the string value derived from the request element must be an exact match to the value property. \
*CONTAINS*: Indicates that the value property must contain the string value derived from the request element. \
*BEGINSWITH*: Indicates that the value property must start with the string value derived from the request element. \
*ENDSWITH*: Indicates that the value property must end with the string value derived from the request element. \
*EQ*: Indicates that the number derived from the variable object must be an exact match to the value property. \
*Note: You should only use EQ when the is_count property has been enabled.* \
*IPMATCH*: Requires that the request's IP address either be contained by an IP block or be an exact match to an IP address defined in the values property. Only use IPMATCH with the REMOTE_ADDR variable.

Optional:

- `is_negated` (Boolean) Indicates whether a condition will be satisfied when the value derived from the request element defined within a variable object matches or does not match the value property.  \
    Valid values are: \
	 *True*: Does not match \
    *False*: Matches
- `value` (String) Indicates a value that will be compared against the string or number value derived from the request element defined within a variable object. \
*Note*: If you are identifying traffic via a URL path (REQUEST_URI), then you should specify a URL path pattern that starts directly after the hostname. Exclude a protocol or a hostname when defining this property. \
Sample Values: /marketing \
/800001/mycustomerorigin


<a id="nestedblock--directive--sec_rule--variable"></a>
### Nested Schema for `directive.sec_rule.variable`

Required:

- `type` (String) Determines the request element that will be assessed. \
    Valid values are: `ARGS_POST | GEO | QUERY_STRING | REMOTE_ADDR | REQUEST_BODY | REQUEST_COOKIES | REQUEST_HEADERS | REQUEST_METHOD | REQUEST_URI` \
    *Note: If a request element consists of one or more key-value pairs, then you may identify a key via a match object. If is_count has been disabled, then you may identify a specific value via the operator object.*

Optional:

- `is_count` (Boolean) Determines whether a comparison will be performed between the operator object and a string value or the number of matches found. \
    Valid values are: \
    *true*: A counter will increment whenever the request element defined by this variable object is found. The operator object will perform a comparison against this number. \
    *Note: If you enable is_count, then you must also set the type property to EQ.* \
    *false*: The operator object will perform a comparison against the string value derived from the request element defined by this variable object.
- `match` (Block List) The match array determines the comparison conditions for the request element identified by the type property. (see [below for nested schema](#nestedblock--directive--sec_rule--variable--match))

<a id="nestedblock--directive--sec_rule--variable--match"></a>
### Nested Schema for `directive.sec_rule.variable.match`

Optional:

- `is_negated` (Boolean) Determines whether this condition is satisfied when the request element identified by the variable object is found or not found. \
    Valid values are: \
    *True*: Not found \
    *False*: Found
- `is_regex` (Boolean) Determines whether the value property will be interpreted as a regular expression. \
    Valid values are: \
    *true*: Regular expression \
    *false*: Default value. Literal value.
- `value` (String) Restricts the match condition defined by the type property to the specified value. \
Example: \
If the type property is set to REQUEST_HEADERS and this property is set to User-Agent, then this match condition is restricted to the User-Agent request header. If the value property is omitted, then this match condition applies to all request headers.



<a id="nestedblock--directive--sec_rule--chained_rule"></a>
### Nested Schema for `directive.sec_rule.chained_rule`

Required:

- `action` (Block Set, Min: 1) Determines whether the string identified in a variable object will be transformed and the metadata that will be assigned to malicious traffic. (see [below for nested schema](#nestedblock--directive--sec_rule--chained_rule--action))
- `operator` (Block Set, Min: 1, Max: 1) Indicates the comparison that will be performed against the request element(s) identified within a variable object. (see [below for nested schema](#nestedblock--directive--sec_rule--chained_rule--operator))

Optional:

- `variable` (Block List) Contains criteria that identifies a request element. (see [below for nested schema](#nestedblock--directive--sec_rule--chained_rule--variable))

<a id="nestedblock--directive--sec_rule--chained_rule--action"></a>
### Nested Schema for `directive.sec_rule.chained_rule.variable`

Optional:

- `id` (String) Determines the custom ID that will be assigned to this custom rule. This custom ID is exposed via the Threats Dashboard. \
    Valid values fall within this range: 66000000 - 66999999 \
    *Note: This field is only applicable for the action object that resides in the root of the sec_rule object.* \
    Default Value: Random number
- `msg` (String) Determines the rule message that will be assigned to this custom rule. This message is exposed via the Threats Dashboard. \
    *Note: This field is only applicable for the action object that resides in the root of the sec_rule object.* \
    Default Value: Blank
- `transformations` (List of String) Determines the set of transformations that will be applied to the value derived from the request element identified in a variable object (i.e., source value). Transformations are always applied to the source value, regardless of the number of transformations that have been defined.  \
Valid Values are: \
*NONE*: Indicates that the source value should not be modified. \
*LOWERCASE*: Indicates that the source value should be converted to lowercase characters. \
*URLDECODE*: Indicates that the source value should be URL decoded. This transformation is useful when the source value has been URL encoded twice. \
*REMOVENULLS*: Indicates that null values should be removed from the source value. \
*Note: A criterion is satisfied if the source value or any of the modified string values meet the conditions defined by the operator object.*


<a id="nestedblock--directive--sec_rule--chained_rule--operator"></a>
### Nested Schema for `directive.sec_rule.chained_rule.variable`

Required:

- `type` (String) Indicates how the system will interpret the comparison between the value property and the value derived from the request element defined within a variable object.  \
Valid Values are: \
*RX*: Indicates that the string value derived from the request element must satisfy the regular expression defined in the value property. \
*STREQ*: Indicates that the string value derived from the request element must be an exact match to the value property. \
*CONTAINS*: Indicates that the value property must contain the string value derived from the request element. \
*BEGINSWITH*: Indicates that the value property must start with the string value derived from the request element. \
*ENDSWITH*: Indicates that the value property must end with the string value derived from the request element. \
*EQ*: Indicates that the number derived from the variable object must be an exact match to the value property. \
*Note: You should only use EQ when the is_count property has been enabled.* \
*IPMATCH*: Requires that the request's IP address either be contained by an IP block or be an exact match to an IP address defined in the values property. Only use IPMATCH with the REMOTE_ADDR variable.

Optional:

- `is_negated` (Boolean) Indicates whether a condition will be satisfied when the value derived from the request element defined within a variable object matches or does not match the value property.  \
    Valid values are: \
	 *True*: Does not match \
    *False*: Matches
- `value` (String) Indicates a value that will be compared against the string or number value derived from the request element defined within a variable object. \
*Note*: If you are identifying traffic via a URL path (REQUEST_URI), then you should specify a URL path pattern that starts directly after the hostname. Exclude a protocol or a hostname when defining this property. \
Sample Values: /marketing \
/800001/mycustomerorigin


<a id="nestedblock--directive--sec_rule--chained_rule--variable"></a>
### Nested Schema for `directive.sec_rule.chained_rule.variable`

Required:

- `type` (String) Determines the request element that will be assessed. \
    Valid values are: `ARGS_POST | GEO | QUERY_STRING | REMOTE_ADDR | REQUEST_BODY | REQUEST_COOKIES | REQUEST_HEADERS | REQUEST_METHOD | REQUEST_URI` \
    *Note: If a request element consists of one or more key-value pairs, then you may identify a key via a match object. If is_count has been disabled, then you may identify a specific value via the operator object.*

Optional:

- `is_count` (Boolean) Determines whether a comparison will be performed between the operator object and a string value or the number of matches found. \
    Valid values are: \
    *true*: A counter will increment whenever the request element defined by this variable object is found. The operator object will perform a comparison against this number. \
    *Note: If you enable is_count, then you must also set the type property to EQ.* \
    *false*: The operator object will perform a comparison against the string value derived from the request element defined by this variable object.
- `match` (Block List) The match array determines the comparison conditions for the request element identified by the type property. (see [below for nested schema](#nestedblock--directive--sec_rule--chained_rule--variable--match))

<a id="nestedblock--directive--sec_rule--chained_rule--variable--match"></a>
### Nested Schema for `directive.sec_rule.chained_rule.variable.match`

Optional:

- `is_negated` (Boolean) Determines whether this condition is satisfied when the request element identified by the variable object is found or not found. \
    Valid values are: \
    *True*: Not found \
    *False*: Found
- `is_regex` (Boolean) Determines whether the value property will be interpreted as a regular expression. \
    Valid values are: \
    *true*: Regular expression \
    *false*: Default value. Literal value.
- `value` (String) Restricts the match condition defined by the type property to the specified value. \
Example: \
If the type property is set to REQUEST_HEADERS and this property is set to User-Agent, then this match condition is restricted to the User-Agent request header. If the value property is omitted, then this match condition applies to all request headers.


