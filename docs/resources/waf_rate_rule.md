---
page_title: "edgecast_waf_rate_rule Resource"
subcategory: "Web Application Firewall (WAF)"
description: |-
  edgecast_waf_rate_rule Resource
---

# edgecast_waf_rate_rule Resource
A rate rule restricts the flow of site traffic with the intention of:

* Diverting malicious or inadvertent DDoS traffic.
* Preventing a customer origin server from being overloaded.

[Learn more.](https://docs.edgecast.com/cdn/#Web-Security/Rate-Rules.htm)

Requests that exceed the rate limit may be dropped, redirected to another URL, or sent a custom response. The type of enforcement action that will take place is determined by the [Security Application Manager](https://docs.edgecast.com/cdn/#Web-Security/SAM.htm) configuration that leverages it.

-> You may manage an existing rate rule by importing it as a resource.  
[Learn more.](#import-resource)

## Authentication

This resource requires a [REST API token](../guides/authentication#rest-api-token).

## Example Usage

```terraform
resource "edgecast_waf_rate_rule" "rate_rule_1" {
  account_number = "0001"
  name           = "Rate Rule #1"
  duration_sec   = 1
  keys           = ["IP", "USER_AGENT"]
  disabled       = false
  num            = 10

  condition_group {
    name = "Group 1"

    condition {
      target {
        type = "REMOTE_ADDR"
      }

      op {
        is_case_insensitive = false
        is_negated          = false
        type                = "IPMATCH"                  # only use op.type=IPMATCH when target.type=REMOTE_ADDR
        values              = ["10.10.2.3", "10.10.2.4"] # values array property is required when op.type=EM or op.type=IPMATCH
      }
    }

    condition {
      target {
        type = "REQUEST_METHOD"
      }

      op {
        is_case_insensitive = true
        is_negated          = true
        type                = "EM"
        values              = ["GET", "POST"] # values array property is required when op.type=EM or op.type=IPMATCH
      }
    }

    condition {
      target {
        type = "FILE_EXT"
      }

      op {
        is_case_insensitive = true
        is_negated          = false
        type                = "RX"
        value               = "(.*?)\\.(jpg|gif|doc|pdf)$" # value property is required when op.type=RX
      }
    }
  }
  
  condition_group {
    name = "Group 2"

    condition {
      target {
        type  = "REQUEST_HEADERS"
        value = "User-Agent" # only valid when type=REQUEST_HEADERS. 
      }

      op {
        is_case_insensitive = true
        is_negated          = false
        type                = "EM"
        values              = ["Mozilla/5.0", "Chrome/91.0.4472.114"] # values array property is required when op.type=EM or op.type=IPMATCH
      }

    }
    condition {
      target {
        type = "REQUEST_URI"
      }

      op {
        is_case_insensitive = true
        is_negated          = false
        type                = "EM"
        values              = ["/marketing", "/800001/mycustomerorigin"] # values array property is required when op.type=EM or op.type=IPMATCH
      }

    }
  }

}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `condition_group` (Block Set, Min: 1) Contains the set of condition groups associated with a rule. (see [below for nested schema](#nestedblock--condition_group))
- `duration_sec` (Number) Indicates the length, in seconds, of the rolling window that tracks the number of requests eligible for rate limiting. Valid values are: 

        1 | 5 | 10 | 30 | 60 | 120 | 300
- `num` (Number) Indicates the number of requests required to trigger rate limiting. Use the following formula to determine when rate limiting will be triggered:  
`num` requests per `duration_sec`

### Optional

- `account_number` (String) Identifies your account. Find your account number in the upper right-hand corner of the MCC.
- `disabled` (Boolean) Indicates whether this rate rule will be enforced. Valid values are:  * `true` - Disabled. This rate limit will not be applied to traffic. 
 * `false` - Enabled.
- `keys` (Set of String) Indicates the method by which requests will be grouped for the purposes of this rate rule. Valid values are: 
 * *Missing / Empty Array* - If the `keys` argument is not defined or set to an empty array, all requests will be treated as a single group for the purpose of rate limiting. 
 * `IP` - Indicates that requests will be grouped by IP address. Each unique IP address is considered a separate group. 
 * `USER_AGENT` - Indicates that requests will be grouped by a client's user agent. Each unique combination of IP address and user agent is considered a separate group.
- `name` (String) Assigns a name to this access rule.

### Read-Only

- `id` (String) The ID of this resource.

<a id="nestedblock--condition_group"></a>
### Nested Schema for `condition_group`

Optional:

- `condition` (Block Set) Contains a list of match conditions. (see [below for nested schema](#nestedblock--condition_group--condition))
- `name` (String) Indicates the name of a condition group.

Read-Only:

- `id` (String) Indicates the system-defined alphanumeric ID of a condition group (e.g., `12345678-90ab-cdef-ghij-klmnopqrstuvwxyz1`).

<a id="nestedblock--condition_group--condition"></a>
### Nested Schema for `condition_group.condition`

Optional:

- `op` (Block Set, Max: 1) Contains the match condition's properties (see [below for nested schema](#nestedblock--condition_group--condition--op))
- `target` (Block Set, Max: 1) Describes the type of match condition. (see [below for nested schema](#nestedblock--condition_group--condition--target))

<a id="nestedblock--condition_group--condition--op"></a>
### Nested Schema for `condition_group.condition.op`

Required:

- `type` (String) Indicates how the system will interpret the comparison between the request and the `values` argument. Valid values are: 
 * `EM` - Requires that the request's attribute be set to one of the value(s) defined in the `values` argument. 
 * `IPMATCH` - Requires that the request's IP address either be contained by an IP block or be an exact match to an IP address defined in the `values` argument. 

    ->You may only use `IPMATCH` with the `REMOTE_ADDR` match condition. 
 * `RX` - Requires that the request's attribute be an exact match to the regular expression defined in the `value` argument.

Optional:

- `is_case_insensitive` (Boolean) Indicates whether the comparison between the request and the `values` argument is case-sensitive.
- `is_negated` (Boolean) Indicates whether this match condition will be satisfied when the request matches or does not match the value defined by the `values` argument.
- `value` (String) **type: REQUEST_HEADERS Only:** Indicates the name of the request header through which requests will be identified. Valid values are: 

        Host | Referer | User-Agent
- `values` (Set of String) **EM and IPMATCH Only:** Identifies one or more values used to identify requests that are eligible for rate limiting. 
 * `URL Path` - If you are identifying traffic via a URL path (`REQUEST_URI`), then you should specify a URL path pattern that starts directly after the hostname. Exclude the protocol and hostname when defining this argument.  
**Sample values:** `/marketing` and `/800001/myorigin` 
 * `IP Address` - If you are matching requests by IP address (`REMOTE_ADDR`), make sure to use standard IPv4 and CIDR notation.


<a id="nestedblock--condition_group--condition--target"></a>
### Nested Schema for `condition_group.condition.target`

Required:

- `type` (String) Determines how requests will be identified. Valid values are: 

        FILE_EXT | REMOTE_ADDR | REQUEST_HEADERS | REQUEST_METHOD | REQUEST_URI

Optional:

- `value` (String) **REQUEST_HEADERS Only:** Indicates the name of the request header through which requests will be identified. Valid values are: 

        Host | Referer | User-Agent

## Import Resource
Manage an existing rate rule through Terraform by importing it as a resource. Perform the following steps:
1. Insert an empty resource block within your resource configuration.

        resource "edgecast_waf_rate_rule" "<RESOURCE>" {
          
        }
    **Example:**

        resource "edgecast_waf_rate_rule" "sample_rate_rule" {
          
        }
1. Run the following command to attach an rate rule to your resource configuration.

        terraform import edgecast_waf_rate_rule.<RESOURCE> <ACCOUNT_NUMBER>:<RATE_RULE_ID>
    * `<RESOURCE>` - Replace this term with the name of the resource defined in step 1.
    * `<ACCOUNT_NUMBER>` - Replace this term with your customer account number. Find your account number in the upper right-hand corner of the MCC.
    * `<RATE_RULE_ID>` - Replace this term with the system-defined ID assigned to the desired rate rule. You may retrieve a list of rate rules and their system-defined IDs through our [REST API](https://developer.edgecast.com/cdn/api/index.html#Media_Management/Web-Security/Get-All-Rate-Limits.htm).

    **Example:**

        terraform import edgecast_waf_rate_rule.sample_rate_rule 0001:123456
->Upon running the above command, a resource for that rate rule will be recorded in the state file.
