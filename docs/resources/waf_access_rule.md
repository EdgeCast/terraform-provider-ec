---
page_title: "edgecast_waf_access_rule Resource"
subcategory: "Web Application Firewall (WAF)"
description: |-
  edgecast_waf_access_rule Resource
---

# edgecast_waf_access_rule Resource
Use the `edgecast_waf_access_rule` resource to create an access rule. An access rule identifies legitimate traffic and threats according to the request's traits (e.g., ASN, cookie, country, and IP address). You may define [whitelists](https://docs.edgecast.com/cdn/#Web-Security/Access-Rules.htm#Whitelists), [accesslists](https://docs.edgecast.com/cdn/#Web-Security/Access-Rules.htm#Accesslists), and [blacklists](https://docs.edgecast.com/cdn/#Web-Security/Access-Rules.htm#Blacklists) for each desired category. 

-> You may manage an existing access rule by importing it as a resource.  
[Learn more.](#import-resource)

-> Apply an access rule to your traffic by adding it to a [Security Application Manager](https://docs.edgecast.com/cdn/#Web-Security/SAM.htm) configuration.

## Example Usage

```terraform
resource "edgecast_waf_access_rule" "access_rule_1" {
  account_number                = "0001"
  name                          = "Access Rule #1"
  response_header_name          = "my-response-header-name"
  allowed_http_methods          = ["GET", "POST"]
  allowed_request_content_types = ["application/json","text/html"]
  disallowed_extensions         = [".bat", ".cgi"]
  disallowed_headers            = ["reserved-header-1", "x-reserved-header"]


#Note: ASN access controls must be integer values
  asn {
    accesslist = [12, 200, 465]
    blacklist  = [13, 201, 466]
    whitelist  = [14, 202, 467]
  }

  cookie {
    accesslist = ["MaybeTrustedCookie1", "MaybeTrustedCookie2"]
    blacklist  = ["UntrustedCookie1", "UntrustedCookie2"]
    whitelist  = ["TrustedCookie1", "TrustedCookie2"]
  }

  country {
    accesslist = ["AU", "NZ"]
    blacklist  = ["GB", "EE"]
    whitelist  = ["US", "CAN"]
  }

  ip {
    accesslist = ["10.10.10.114", "10.10.10.115"]
    blacklist  = ["10:0:1::0:3", "10:0:1::0:4"]
    whitelist  = ["10.10.10.200", "10.10.10.201"]
  }

  referer {
    accesslist = ["https://maybetrusted.com", "http://maybestrusted2.com"]
    blacklist  = ["https://untrusted.com", "https://untrusted2.com"]
    whitelist  = ["https://trusted.com", "https://trusted2.com"]
  }

  url {
    accesslist = ["/maybe-trusted", "/maybe-trusted-2"]
    blacklist  = ["/untrusted", "/untrused/.*"]
    whitelist  = ["/trusted-path", "/trusted-path/.*"]
  }

  user_agent {
    accesslist = ["Mozilla\\s.*", "Opera\\s.*"]
    blacklist  = ["curl.*", "PostmanRuntime.*"]
    whitelist  = ["internal-tool/v1", "internal-tool/v2"]
  }
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `name` (String) Assigns a name to this access rule.

### Optional

- `account_number` (String) Identifies your account. Find your account number in the upper right-hand corner of the MCC.
- `allowed_http_methods` (List of String) Identifies each allowed HTTP method (e.g., GET).
- `allowed_request_content_types` (List of String) Identifies each allowed media type (e.g., application/json).
- `asn` (Block Set, Max: 1) Contains access controls for autonomous system numbers (ASNs). (see [below for nested schema](#nestedblock--asn))
- `cookie` (Block Set, Max: 1) Contains access controls for cookies. (see [below for nested schema](#nestedblock--cookie))
- `country` (Block Set, Max: 1) Contains access controls for countries. Specify each desired country using its country code. (see [below for nested schema](#nestedblock--country))
- `disallowed_extensions` (List of String) Indicates each file extension for which WAF will send an alert or block the request.
- `disallowed_headers` (List of String) Indicates each request header for which WAF will send an alert or block the request.
- `ip` (Block Set, Max: 1) Contains access controls for IPv4 and/or IPv6 addresses. Specify each desired IP address using standard IPv4/IPv6 and CIDR notation. (see [below for nested schema](#nestedblock--ip))
- `referer` (Block Set, Max: 1) Contains access controls for referrers. Specify a regular expression when defining a referrer. (see [below for nested schema](#nestedblock--referer))
- `response_header_name` (String) Determines the name of the response header that will be included with blocked requests.
- `url` (Block Set, Max: 1) Contains access controls for URL paths. Specify a regular expression for the URL path pattern that starts directly after the hostname. Exclude the protocol and hostname when defining a URL path.  
**Sample values:** `/marketing` and `/800001/myorigin` (see [below for nested schema](#nestedblock--url))
- `user_agent` (Block Set, Max: 1) Contains access controls for user agents. Specify a regular expression when defining a user agent. (see [below for nested schema](#nestedblock--user_agent))

### Read-Only

- `id` (String) The ID of this resource.

<a id="nestedblock--asn"></a>
### Nested Schema for `asn`

Optional:

- `accesslist` (List of Number) Contains entries that identify traffic that may access your content upon passing a threat assessment.
- `blacklist` (List of Number) Contains entries that identify traffic that will be blocked or for which an alert will be generated.
- `whitelist` (List of Number) Contains entries that identify traffic that may access your content without undergoing threat assessment.


<a id="nestedblock--cookie"></a>
### Nested Schema for `cookie`

Optional:

- `accesslist` (List of String) Contains entries that identify traffic that may access your content upon passing a threat assessment.
- `blacklist` (List of String) Contains entries that identify traffic that will be blocked or for which an alert will be generated.
- `whitelist` (List of String) Contains entries that identify traffic that may access your content without undergoing threat assessment.


<a id="nestedblock--country"></a>
### Nested Schema for `country`

Optional:

- `accesslist` (List of String) Contains entries that identify traffic that may access your content upon passing a threat assessment.
- `blacklist` (List of String) Contains entries that identify traffic that will be blocked or for which an alert will be generated.
- `whitelist` (List of String) Contains entries that identify traffic that may access your content without undergoing threat assessment.


<a id="nestedblock--ip"></a>
### Nested Schema for `ip`

Optional:

- `accesslist` (List of String) Contains entries that identify traffic that may access your content upon passing a threat assessment.
- `blacklist` (List of String) Contains entries that identify traffic that will be blocked or for which an alert will be generated.
- `whitelist` (List of String) Contains entries that identify traffic that may access your content without undergoing threat assessment.


<a id="nestedblock--referer"></a>
### Nested Schema for `referer`

Optional:

- `accesslist` (List of String) Contains entries that identify traffic that may access your content upon passing a threat assessment.
- `blacklist` (List of String) Contains entries that identify traffic that will be blocked or for which an alert will be generated.
- `whitelist` (List of String) Contains entries that identify traffic that may access your content without undergoing threat assessment.


<a id="nestedblock--url"></a>
### Nested Schema for `url`

Optional:

- `accesslist` (List of String) Contains entries that identify traffic that may access your content upon passing a threat assessment.
- `blacklist` (List of String) Contains entries that identify traffic that will be blocked or for which an alert will be generated.
- `whitelist` (List of String) Contains entries that identify traffic that may access your content without undergoing threat assessment.


<a id="nestedblock--user_agent"></a>
### Nested Schema for `user_agent`

Optional:

- `accesslist` (List of String) Contains entries that identify traffic that may access your content upon passing a threat assessment.
- `blacklist` (List of String) Contains entries that identify traffic that will be blocked or for which an alert will be generated.
- `whitelist` (List of String) Contains entries that identify traffic that may access your content without undergoing threat assessment.

## Import Resource
Manage an existing access rule through Terraform by importing it as a resource. Perform the following steps:
1. Insert an empty resource block within your resource configuration.

        resource "edgecast_waf_access_rule" "<RESOURCE>" {
          
        }
    **Example:**

        resource "edgecast_waf_access_rule" "sample_access_rule" {
          
        }
1. Run the following command to attach an access rule to your resource configuration.

        terraform import edgecast_waf_access_rule.<RESOURCE> <ACCOUNT_NUMBER>:<ACCESS_RULE_ID>
    * `<RESOURCE>` - Replace this term with the name of the resource defined in step 1.
    * `<ACCOUNT_NUMBER>` - Replace this term with your customer account number. Find your account number in the upper right-hand corner of the MCC.
    * `<ACCESS_RULE_ID>` - Replace this term with the system-defined ID assigned to the desired access rule. You may retrieve a list of access rules and their system-defined IDs through our [REST API](https://developer.edgecast.com/cdn/api/index.html#Media_Management/Web-Security/Get-All-ACLs.htm).

    **Example:**

        terraform import edgecast_waf_access_rule.sample_access_rule 0001:123456
->Upon running the above command, a resource for that access rule will be recorded in the state file.